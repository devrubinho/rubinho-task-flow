---
description: Commit practices after task and subtask completion, including automatic message suggestions
globs: **/*
alwaysApply: true
---

- **Notification and Commit Suggestion After Tasks:**
  - **Always notify user** when a task or subtask is marked as `done`
  - **Suggest a commit message** based on changes made
  - **Include context** of task/subtask in commit suggestion
  - **CRITICAL: NEVER execute git commands** - only suggest, user executes

- **When to Apply:**
  - After `set_task_status` with status `done` for any task or subtask
  - After complete implementation of a subtask
  - After completion of a parent task (when all subtasks are done)

- **Commit Suggestion Format:**
  ```bash
  # ‚úÖ DO: Recommended format
  git commit -m "feat(module): Short description of change
  
  - Implementation details
  - Task/Subtask ID: X.Y
  - Main changes made"
  
  # Real example:
  git commit -m "feat(auth): Implement user login validation
  
  - Add email format validation
  - Add password strength checks
  - Task ID: 3.2"
  ```

- **Suggestion Process:**
  1. **Analyze changes**: Use `git status` and `git diff` to identify modified files (read-only, never modify)
  2. **Extract task context**: Include task/subtask ID and title/description
  3. **Generate message**: Create message following conventional commits
  4. **Present to user**: Show formatted suggestion ready to use
  5. **NEVER execute**: Only suggest, user decides when and how to commit

- **Commit Types (Conventional Commits):**
  - `feat`: New feature (complete task)
  - `fix`: Bug fix
  - `refactor`: Refactoring without behavior change
  - `docs`: Documentation changes
  - `style`: Formatting, semicolons, etc (no code change)
  - `test`: Test addition or fix
  - `chore`: Build, dependency changes, etc

- **Suggested Message Structure:**
  ```bash
  <type>(<scope>): <short description>
  
  <optional body with details>
  - Task/Subtask: <ID>
  - Modified files: <summary list>
  ```

- **Suggestion Examples:**
  
  **For implementation subtask:**
  ```bash
  git commit -m "feat(api): Add user authentication endpoint
  
  - Implement POST /api/auth/login
  - Add JWT token generation
  - Add input validation middleware
  - Subtask ID: 5.3"
  ```
  
  **For complete task:**
  ```bash
  git commit -m "feat(dashboard): Complete user analytics dashboard
  
  - Add real-time metrics display
  - Implement chart visualizations
  - Add data export functionality
  - Task ID: 7"
  ```
  
  **For fix:**
  ```bash
  git commit -m "fix(auth): Resolve token expiration issue
  
  - Fix JWT refresh logic
  - Update token validation
  - Subtask ID: 8.1"
  ```

- **Useful Commands for Analysis:**
  - `git status --short` - List modified files compactly
  - `git diff --stat` - Change statistics
  - `git diff --name-only` - Only names of modified files
  - `git log --oneline -5` - Last commits for context

- **When NOT to Suggest Commit:**
  - ‚ùå DON'T: If there are no git changes (no modified files)
  - ‚ùå DON'T: If user already committed recently (last 5 minutes)
  - ‚ùå DON'T: If there are unresolved merge conflicts
  - ‚ùå DON'T: If repository is not a git repo

- **Suggestion Presentation:**
  - **Always notify user** when a task/subtask is completed with clear message and emoji ‚úÖ
  - **Show formatted suggestion** ready to copy/paste
  - **Include statistics** of changes (modified files, lines added/removed)
  
  **Presentation example:**
  ```markdown
  ‚úÖ Task 3.2 completed!
  
  üìù Commit suggestion:
  ```bash
  git commit -m "feat(module): Change description
  
  - Detail 1
  - Detail 2
  - Task ID: 3.2"
  ```
  
  üìä Changes detected:
  - 3 files modified
  - 45 lines added, 12 removed
  ```

- **Integration with RBIN Task Flow:**
  - After marking a task as completed, automatically:
    1. Check if there are git changes
    2. Analyze modified files
    3. Generate commit suggestion based on task
    4. Present to user clearly

- **Git Control:**
  - **NEVER execute git commands** - only suggest
  - Follow [git_control.mdc](mdc:.cursor/rules/git_control.mdc) for complete user control over git
  - Present suggestions ready for user to copy and execute

- **References:**
  - Follow [Conventional Commits](https://www.conventionalcommits.org/) patterns
  - Integrate with RBIN Task Flow workflow
  - Git control: [git_control.mdc](mdc:.cursor/rules/git_control.mdc)